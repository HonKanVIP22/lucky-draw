<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Lucky Draw Pro</title>

<style>
/* ====== GI·ªÆ NGUY√äN CSS C·ª¶A B·∫†N ====== */
body{
  background:url("nen.jpg") center/cover no-repeat fixed;
  font-family:'Segoe UI',Arial;
  color:#fff;
  text-align:center;
  margin:0;
  min-height:100vh;
}
.overlay{background:rgba(0,0,0,.35);min-height:100vh;padding-top:50px}
h1{font-size:64px;font-weight:900;letter-spacing:4px;margin-bottom:28px;
background:linear-gradient(90deg,#fff176,#ffeb3b,#ffc107);
-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.title-icon{animation:rotateSlow 8s linear infinite;margin-right:14px;display:inline-block}

.slot{display:flex;justify-content:center;gap:16px;margin:30px 0}
.digit{width:84px;height:118px;background:linear-gradient(180deg,#ffeb3b,#ffc107);
color:#5d4037;font-size:66px;font-weight:900;border-radius:16px;
display:flex;align-items:center;justify-content:center}

#spinBtn{width:190px;height:190px;border-radius:50%;
background:radial-gradient(circle,#ffeb3b,#ffc107);
font-size:34px;font-weight:900;border:none;cursor:pointer}

.right-panel{position:fixed;top:20px;right:20px;background:rgba(0,0,0,.4);
padding:12px;border-radius:16px;display:flex;flex-direction:column;gap:10px}
.right-panel select,.right-panel input{
width:150px;padding:8px;border-radius:12px;background:rgba(0,0,0,.5);
color:#fff;border:none;text-align:center}
.export{background:#d50000;color:#fff}
.reset{background:#0d47a1;color:#fff}

/* ===== WINNER ===== */
#winnerBox{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);
z-index:9999;align-items:center;justify-content:center}
#winnerContent{background:rgba(0,0,0,.85);padding:40px 60px;border-radius:30px;
box-shadow:0 0 50px rgba(255,215,0,.9);position:relative}
#winnerContent h2{color:#ffeb3b;font-size:36px}

/* ‚ùå N√öT ƒê√ìNG */
#closeWinner{
position:absolute;top:14px;right:18px;
width:40px;height:40px;border-radius:50%;
border:none;background:#d50000;color:#fff;
font-size:22px;cursor:pointer}

/* DANH S√ÅCH NHI·ªÄU NG∆Ø·ªúI */
#winnerList{margin-top:20px}
.winner-item{font-size:38px;font-weight:900;margin:14px 0}
.winner-item span{display:block;font-size:20px;opacity:.85}

.sparkle{position:absolute;font-size:26px;animation:sparkle 1.5s infinite}
.confetti{position:absolute;font-size:26px;animation:floatUp 2.8s linear infinite}

/* ===== THAN TAI + NG·ª∞A GI·ªÆ NGUY√äN ===== */
.thantai-box{position:fixed;right:20px;bottom:40px;width:240px;z-index:998;
text-align:center;animation:thantaiSwing 3s ease-in-out infinite}
.thantai-text{background:linear-gradient(90deg,#ffeb3b,#ffc107);
color:#5d4037;font-weight:900;padding:8px 14px;border-radius:20px}

.horse-run{position:fixed;top:20px;left:-220px;width:300px;
animation:horseRun 12s linear infinite;pointer-events:none}

@keyframes floatUp{to{transform:translateY(-140px) rotate(360deg);opacity:0}}
@keyframes sparkle{50%{opacity:1;transform:scale(1.2)}}
@keyframes rotateSlow{to{transform:rotate(360deg)}}
@keyframes thantaiSwing{50%{transform:rotate(5deg)}}
@keyframes horseRun{to{left:110%}}
</style>
</head>

<body>

<div class="right-panel">
  <select id="prize">
    <option>Gi·∫£i Nh·∫•t</option>
    <option>Gi·∫£i Nh√¨</option>
    <option>Gi·∫£i Ba</option>
    <option>Gi·∫£i Th∆∞·ªüng</option>
  </select>
  <input id="drawCount" type="number" value="1" min="1">
  <button class="export" onclick="exportCSV()">üì• Xu·∫•t</button>
  <button class="reset" onclick="resetAll()">üîÑ Reset</button>
</div>

<!-- WINNER -->
<div id="winnerBox">
  <div id="winnerContent">
    <button id="closeWinner" onclick="closeWinner()">‚úñ</button>
    <h2>üéâ CH√öC M·ª™NG üéâ</h2>
    <div id="winnerList"></div>
  </div>
</div>

<div id="confettiArea"></div>

<div class="overlay">
<h1><span class="title-icon">üéØ</span>QUAY S·ªê MAY M·∫ÆN</h1>

<div class="slot">
  <div class="digit">0</div><div class="digit">0</div>
  <div class="digit">0</div><div class="digit">0</div>
  <div class="digit">0</div>
</div>

<button id="spinBtn" onclick="draw()">QUAY</button>
</div>

<!-- NG·ª∞A + TH·∫¶N T√ÄI -->
<div class="horse-run"><img src="ngua.png"></div>
<div class="thantai-box">
  <div class="thantai-text">‚ú® Ng∆∞·ªùi ·∫§y L√† Ai?? ‚ú®</div>
  <img src="thantai.png">
</div>

<script>
const defaultItems=[
 {code:"00001",name:"Nguy·ªÖn VƒÉn Kan"},
 {code:"00002",name:"Tr·∫ßn Th·ªã Ng√¢n"},
 {code:"00003",name:"L√™ VƒÉn C"},
 {code:"00004",name:"Ph·∫°m Th·ªã D"},
 {code:"00005",name:"Ho√†ng VƒÉn E"},
 {code:"00006",name:"Ho√†ng VƒÉn Kong"},
];

let items=[...defaultItems];
let results=[];

function spinDigits(target){
 let d=document.querySelectorAll(".digit");
 let i=0;
 let t=setInterval(()=>{
  d.forEach(x=>x.innerText=Math.floor(Math.random()*10));
  if(++i>30){clearInterval(t);
   target.code.split("").forEach((n,j)=>d[j].innerText=n);}
 },100);
}

function draw(){
 let count=+drawCount.value||1;
 if(count>items.length){alert("Kh√¥ng ƒë·ªß ng∆∞·ªùi");return;}

 let winners=[];
 for(let i=0;i<count;i++){
  let idx=Math.floor(Math.random()*items.length);
  winners.push(items.splice(idx,1)[0]);
 }

 spinDigits(winners[0]);
 setTimeout(()=>showMultiWinners(winners),2000);
}

function showMultiWinners(list){
 winnerList.innerHTML="";
 list.forEach(w=>{
  winnerList.innerHTML+=`
   <div class="winner-item">${w.name}
   <span>M√£ s·ªë: ${w.code}</span></div>`;
 });

 winnerBox.style.display="flex";

 let area=document.getElementById("confettiArea");
 area.innerHTML="";
 for(let i=0;i<20;i++){
  let c=document.createElement("div");
  c.className="confetti";
  c.innerText=["üéâ","‚ú®","‚≠ê"][Math.floor(Math.random()*3)];
  c.style.left=Math.random()*100+"%";
  c.style.bottom="10%";
  area.appendChild(c);
 }
}

function closeWinner(){
 winnerBox.style.display="none";
 confettiArea.innerHTML="";
}
</script>
</body>
</html>
