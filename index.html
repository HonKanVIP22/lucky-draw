<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Lucky Draw Pro</title>

<style>
body{
  background:url("nen.jpg") center/cover no-repeat fixed;
  font-family:'Segoe UI',Arial;
  color:#fff;
  text-align:center;
  margin:0;
  min-height:100vh;
}
.overlay{
  background:rgba(0,0,0,0.35);
  min-height:100vh;
  padding-top:50px;
}
h1{
  font-size:56px;
  margin-bottom:25px;
  letter-spacing:3px;
  text-shadow:0 4px 10px rgba(0,0,0,.6);
}
select{
  padding:12px 20px;
  font-size:20px;
  border-radius:12px;
  border:none;
  outline:none;
  margin-bottom:25px;
}

/* ===== SLOT ===== */
.slot{
  display:flex;
  justify-content:center;
  gap:14px;
  margin:30px 0;
}
.digit{
  width:80px;
  height:110px;
  background:#1b5e20;
  color:#fff;
  font-size:64px;
  font-weight:bold;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:
    inset 0 -8px 0 rgba(0,0,0,.35),
    0 10px 25px rgba(0,0,0,.5);
  transition:transform .12s;
}

/* ===== BUTTONS ===== */
#spinBtn{
  width:170px;
  height:170px;
  border-radius:50%;
  background:#2e7d32;
  color:#fff;
  font-size:32px;
  font-weight:bold;
  border:none;
  cursor:pointer;
  box-shadow:0 15px 35px rgba(0,0,0,.6);
}
#spinBtn:hover{background:#43a047;transform:scale(1.08)}

#exportBtn{
  margin-top:20px;
  background:#e53935;
  color:#fff;
  padding:14px 40px;
  border-radius:40px;
  font-size:20px;
  border:none;
  cursor:pointer;
  box-shadow:0 10px 25px rgba(0,0,0,.5);
}
#resetBtn{
  margin-top:14px;
  background:#1565c0;
  color:#fff;
  padding:14px 44px;
  border-radius:40px;
  font-size:20px;
  font-weight:bold;
  border:none;
  cursor:pointer;
  box-shadow:0 12px 30px rgba(0,0,0,.6);
}
#resetBtn:hover{background:#1e88e5;transform:scale(1.05)}

/* ===== B·∫¢NG K·∫æT QU·∫¢ ===== */
.result-box{
  margin:40px auto;
  width:85%;
  max-width:950px;
  background:rgba(0,0,0,0.45);
  border-radius:20px;
  padding:22px 26px;
  box-shadow:0 18px 45px rgba(0,0,0,.6);
  backdrop-filter:blur(6px);
}
.result-title{
  font-size:26px;
  margin-bottom:18px;
  letter-spacing:1px;
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:18px;
}
thead{
  background:rgba(255,255,255,0.18);
}
th,td{
  padding:12px 14px;
  text-align:left;
}
th{
  font-size:15px;
  text-transform:uppercase;
}
tbody tr{
  border-bottom:1px solid rgba(255,255,255,0.18);
}
tbody tr:nth-child(even){
  background:rgba(255,255,255,0.06);
}
.prize{color:#ffd54f;font-weight:bold}
.code{font-family:monospace;font-size:19px}
</style>
</head>

<body>
<div class="overlay">

<h1>üéØ QUAY S·ªê MAY M·∫ÆN</h1>

üéÅ <b>Ch·ªçn gi·∫£i:</b><br>
<select id="prize">
  <option>Gi·∫£i Nh·∫•t</option>
  <option>Gi·∫£i Nh√¨</option>
  <option>Gi·∫£i Ba</option>
  <option>Khuy·∫øn Kh√≠ch</option>
</select>

<div class="slot">
  <div class="digit">0</div>
  <div class="digit">0</div>
  <div class="digit">0</div>
  <div class="digit">0</div>
  <div class="digit">0</div>
</div>

<button id="spinBtn" onclick="draw()">QUAY</button><br>
<button id="exportBtn" onclick="exportCSV()">üì• Xu·∫•t k·∫øt qu·∫£</button><br>
<button id="resetBtn" onclick="resetAll()">üîÑ RESET</button>

<!-- ===== B·∫¢NG ===== -->
<div class="result-box">
  <div class="result-title">üèÜ DANH S√ÅCH TR√öNG TH∆Ø·ªûNG</div>
  <table>
    <thead>
      <tr>
        <th>Gi·∫£i</th>
        <th>M√£ s·ªë</th>
        <th>H·ªç t√™n</th>
      </tr>
    </thead>
    <tbody id="resultTable"></tbody>
  </table>
</div>

</div>

<script>
const KEY_ITEMS="LUCKY_ITEMS";
const KEY_RESULTS="LUCKY_RESULTS";

const defaultItems=[
 {code:"00001",name:"Nguy·ªÖn VƒÉn A"},
 {code:"00002",name:"Tr·∫ßn Th·ªã B"},
 {code:"00003",name:"L√™ VƒÉn C"},
 {code:"00004",name:"Ph·∫°m Th·ªã D"},
 {code:"00005",name:"Ho√†ng VƒÉn E"},
];

let items=JSON.parse(localStorage.getItem(KEY_ITEMS))||[...defaultItems];
let results=JSON.parse(localStorage.getItem(KEY_RESULTS))||[];

window.onload=renderTable;

/* ===== SLOT EFFECT ===== */
function spinDigits(target){
  let d=document.querySelectorAll(".digit");
  let i=0;
  let it=setInterval(()=>{
    d.forEach(x=>x.innerText=Math.floor(Math.random()*10));
    if(++i>22){
      clearInterval(it);
      target.code.split("").forEach((n,j)=>d[j].innerText=n);
    }
  },70);
}

/* ===== DRAW ===== */
function draw(){
  if(items.length===0){alert("H·∫æT DANH S√ÅCH");return;}
  let i=Math.floor(Math.random()*items.length);
  let item=items.splice(i,1)[0];
  spinDigits(item);

  let prize=document.getElementById("prize").value;
  results.push({prize,...item});

  localStorage.setItem(KEY_ITEMS,JSON.stringify(items));
  localStorage.setItem(KEY_RESULTS,JSON.stringify(results));

  setTimeout(renderTable,2000);
}

/* ===== TABLE ===== */
function renderTable(){
  let tb=document.getElementById("resultTable");
  tb.innerHTML="";
  results.forEach(r=>{
    tb.innerHTML+=`
      <tr>
        <td class="prize">${r.prize}</td>
        <td class="code">${r.code}</td>
        <td>${r.name}</td>
      </tr>`;
  });
}

/* ===== EXPORT ===== */
function exportCSV(){
  let csv="Prize,Code,Name\n";
  results.forEach(r=>csv+=`${r.prize},${r.code},${r.name}\n`);
  let a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv]));
  a.download="ketqua_quayso.csv";
  a.click();
}

/* ===== RESET ===== */
function resetAll(){
  if(!confirm("RESET to√†n b·ªô d·ªØ li·ªáu?"))return;
  localStorage.clear();
  items=[...defaultItems];
  results=[];
  renderTable();
  document.querySelectorAll(".digit").forEach(d=>d.innerText="0");
}

/* PH√çM T·∫ÆT */
document.addEventListener("keydown",e=>{
  if(e.ctrlKey&&e.altKey&&e.key==="R") resetAll();
});
</script>
</body>
</html>
